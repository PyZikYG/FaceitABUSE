name: Create Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Create extension package
      run: |
        mkdir -p release
        cp manifest.json popup.html popup.js content.js icon.svg create_icons.html release/
        cd release
        zip -r ../faceit-auto-match-finder-${{ github.ref_name }}.zip .
        
    - name: Create Release
      uses: actions/create-release@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        tag_name: ${{ github.ref }}
        release_name: FACEIT Auto Match Finder ${{ github.ref }}
        body: |
          ## –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏
          
          ### üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
          - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–ù–∞–π—Ç–∏ –º–∞—Ç—á" –Ω–∞ FACEIT
          - –î–≤–∞ —Ä–µ–∂–∏–º–∞: –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ + –∞–≤—Ç–æ–ø–æ–∏—Å–∫
          - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
          - –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
          - –£–º–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏
          
          ### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
          1. –°–∫–∞—á–∞–π—Ç–µ `faceit-auto-match-finder-${{ github.ref_name }}.zip`
          2. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤
          3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Chrome –∫–∞–∫ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
          
          ### ‚ö†Ô∏è –í–∞–∂–Ω–æ
          –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∞–π—Ç–µ FACEIT.com
        draft: false
        prerelease: false
        
    - name: Upload Release Asset
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: ./faceit-auto-match-finder-${{ github.ref_name }}.zip
        asset_name: faceit-auto-match-finder-${{ github.ref_name }}.zip
        asset_content_type: application/zip